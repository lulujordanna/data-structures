<!DOCTYPE html>
<meta charset="utf-8">

<head>
   <link rel="stylesheet" href="./styles.css">
   <link href="https://fonts.googleapis.com/css?family=Noto+Sans+KR:100,300,400,700&display=swap" rel="stylesheet"> 
</head>

<body>
   <h1 class="header"><span style="color:#6daaa5;">Cool November:</span> <span style="font-weight:100;">A Temperature Visualization</span></h1>
   <hr>
   
   <div class="sensorGrid">
      <p>With the notorious New York City heating regulations, finding the perfect temperature in one&apos;s bedroom during the winter can be a difficult task. I began running my air conditioner to combat the heating in my unit. This visualization records the average hourly temperature of my bedroom over the course of a month and highlights when the air conditioner is running to highlight electricity waste. </p>
   </div>
   
   <section id="sensorGraph"></section>
   
   <script src="https://d3js.org/d3.v4.js"></script>
   <script> 
   var data ={{{sensorData}}}
   
   // set the dimensions and margins of the graph
   var margin = {top: 10, right: 30, bottom: 30, left: 20},
       width = 1200 - margin.left - margin.right,
       height = 400 - margin.top - margin.bottom;
   
   // append the svg object to the body of the page
   var svg = d3.select("#sensorGraph")
     .append("svg")
       .attr("width", width + margin.left + margin.right)
       .attr("height", height + margin.top + margin.bottom)
     .append("g")
       .attr("transform",
             "translate(" + margin.left + "," + margin.top + ")");
   
   draw(); 
   
   function draw(){
   
   //Mapping data from SQL query to d3
     data = data.map(function(d){
       return { date : d3.timeParse("%Y-%m-%dT%H")(d.sensoryear + '-' + d.sensormonth + '-' + d.sensorday + 'T' + d.sensorhour), value : d.temp_value }
     })
     
       // X axis
       var x = d3.scaleTime()
         .domain(d3.extent(data, function(d) { return d.date; }))
         .range([ 0, width ]);
       svg.append("g")
         .attr("transform", "translate(0," + height + ")")
         .call(d3.axisBottom(x));
   
       // Y axis
       var y = d3.scaleLinear()
         .domain([0, d3.max(data, function(d) { return +d.value; })])
         .range([ height, 0 ]);
       svg.append("g")
         .call(d3.axisLeft(y));
   
       // The line
       svg.append("path")
         .datum(data)
         .attr("fill", "none")
         .attr("stroke", "#6daaa5")
         .attr("stroke-width", 2)
         .attr("d", d3.line()
           .x(function(d) { return x(d.date) })
           .y(function(d) { return y(d.value) })
           )
       
       //The benchmark line
       svg.append("line")    
          .attr("x1", 0)
          .attr("y1", 95)
          .attr("x2", 1150)
          .attr("y2", 95)
          .attr("stroke", "#6daaa5")
          .attr("stroke-width", 1) 
          .attr("stroke-dasharray", ("3, 3"));
   }
   
   </script>
</body>